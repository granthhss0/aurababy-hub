<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>Movement Hub</title>

<!-- React UMD (NO MODULE ERRORS) -->
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

<!-- Socket.IO CLIENT -->
<script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>

<style>
/* ====== YOUR CSS â€” UNCHANGED ====== */
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@800;900&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{overflow:hidden;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif}
.screen{width:100vw;height:100vh;background:linear-gradient(135deg,#1e3a8a 0%,#581c87 50%,#312e81 100%);position:relative}
.grid-bg{position:absolute;inset:0;opacity:.2;background-image:linear-gradient(rgba(255,255,255,.1) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,.1) 1px,transparent 1px);background-size:50px 50px}
.player{position:absolute;width:48px;height:48px;border-radius:8px;box-shadow:0 0 20px rgba(34,211,238,.6)}
.username-label{position:absolute;background:rgba(0,0,0,.7);color:#22d3ee;padding:4px 12px;border-radius:6px;font-size:14px;font-weight:800;transform:translateX(-50%)}
.hud{position:absolute;top:16px;left:16px;background:rgba(0,0,0,.5);backdrop-filter:blur(10px);color:white;padding:12px 16px;border-radius:8px}
.babies-button{width:100%;margin-bottom:8px;padding:8px;border:none;border-radius:6px;background:linear-gradient(90deg,#22d3ee,#3b82f6);color:white;font-weight:800;cursor:pointer}
.center-container{display:flex;align-items:center;justify-content:center;width:100vw;height:100vh}
.welcome-box{background:rgba(0,0,0,.5);padding:32px;border-radius:16px;width:90%;max-width:420px;color:white}
.input{width:100%;padding:12px;border-radius:8px;background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.3);color:white;margin-bottom:12px}
.button{width:100%;padding:12px;border-radius:8px;background:linear-gradient(90deg,#22d3ee,#3b82f6);border:none;color:white;font-weight:800}
</style>
</head>

<body>
<div id="root"></div>

<script>
const { useState, useEffect, useRef } = React;

const socket = io("https://aurababy-hub0.onrender.com", {
  transports: ["websocket"]
});

const characters = {
  aurababy:{image:"https://i.ibb.co/nq467xv6/aurababy.png"},
  goonerbaby:{image:"https://i.ibb.co/ZRPGHj01/goonerbaby.png"},
  fattiebaby:{image:"https://i.ibb.co/Kj0gKt2Q/fattiebaby.png"},
  zoely:{image:"https://i.ibb.co/PsXr9KgX/zoely.png"},
  hollybaby:{image:"https://i.ibb.co/DD8Py8yW/hollybaby.png"},
  jollybaby:{image:"https://i.ibb.co/8DNHS4n9/jollybaby.png"}
};

function MovementHub(){
  const [username,setUsername]=useState(localStorage.getItem("movement_user"));
  const [input,setInput]=useState("");
  const [players,setPlayers]=useState({});
  const [character,setCharacter]=useState("aurababy");

  const pos=useRef({x:200,y:200});
  const keys=useRef({});

  useEffect(()=>{
    socket.on("players:state", state=>{
      setPlayers(state || {});
    });
    socket.on("player:left", ({id})=>{
      setPlayers(p=>{
        const n={...p}; delete n[id]; return n;
      });
    });
  },[]);

  useEffect(()=>{
    if(!username) return;
    socket.emit("join",{
      id: socket.id,
      username,
      x:pos.current.x,
      y:pos.current.y,
      character
    });
  },[username,character]);

  useEffect(()=>{
    if(!username) return;

    const down=e=>keys.current[e.key]=true;
    const up=e=>keys.current[e.key]=false;
    window.addEventListener("keydown",down);
    window.addEventListener("keyup",up);

    const loop=()=>{
      let dx=0,dy=0;
      if(keys.current.w)dy--;
      if(keys.current.s)dy++;
      if(keys.current.a)dx--;
      if(keys.current.d)dx++;
      pos.current.x+=dx*4;
      pos.current.y+=dy*4;

      socket.emit("player:update",{
        x:pos.current.x,
        y:pos.current.y
      });

      requestAnimationFrame(loop);
    };
    loop();
  },[username]);

  if(!username){
    return React.createElement("div",{className:"screen center-container"},
      React.createElement("div",{className:"welcome-box"},
        React.createElement("input",{className:"input",placeholder:"Username",value:input,onChange:e=>setInput(e.target.value)}),
        React.createElement("button",{className:"button",onClick:()=>{
          localStorage.setItem("movement_user",input);
          setUsername(input);
        }},"Start")
      )
    );
  }

  return React.createElement("div",{className:"screen"},
    React.createElement("div",{className:"grid-bg"}),

    Object.entries(players).map(([id,p])=>
      React.createElement(React.Fragment,{key:id},
        React.createElement("div",{className:"player",style:{left:p.x,top:p.y}},
          React.createElement("img",{src:characters[p.character]?.image,style:{width:"100%",height:"100%"}})
        ),
        React.createElement("div",{className:"username-label",style:{left:p.x+24,top:p.y+56}},p.username)
      )
    ),

    React.createElement("div",{className:"hud"},
      React.createElement("button",{className:"babies-button"},"ðŸ‘¶ Babies")
    )
  );
}

ReactDOM.createRoot(document.getElementById("root"))
  .render(React.createElement(MovementHub));
</script>
</body>
</html>
